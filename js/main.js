// Generated by CoffeeScript 1.6.1
(function(){var e;e="http://www.pbs.org/";$(document).ready(function(){var t,n,r,i,s,o,u,a;n=$(window);r=n.height();t=$(document).height();o=1;(a=function(){window.requestAnimationFrame(a);return o=n.scrollTop()})();n.on("resize",function(){return r=n.height()});$.fn.parallax=function(e){var t,r,i,s;t=$(this);if(t.length===0)return;i=t.offset().top;r=Modernizr.prefixed("transform");n.on("resize",function(){return i=t.offset().top});return(s=function(){var n;window.requestAnimationFrame(s);n=Modernizr.csstransforms3d?"translate3d(0, "+Math.floor((i-o)*e)+"px, 0)":"translateY("+(i-o)*e+"px)";return t.css(r,n)})()};$(".background_image","section").each(function(){return $(this).parallax(-0.3)});$(".background_image",".company_photo").parallax(.3);u={};(s=function(){return setTimeout(function(){var e;for(e in u)u[e]();return n.one("scroll",s)},300)})();$("input").each(function(){var e,t;e=$(this);t=$.cookie("retiring__"+e.attr("name"));if(t)return e.val(t)});$("input").on("keyup change",function(e){var t;t=$(this);return $.cookie("retiring__"+t.attr("name"),t.val(),{expires:1})});i="https://docs.google.com/forms/d/1cujY_8JrgdzcwsScxv47lF_BY-g9Oz6u0vlrDNjZxGY/formResponse";$("#the_form").submit(function(e){var t;e.preventDefault();$(this).find("input").attr("disabled","disabled").val("Sending...");t={"entry.1728150349":$.cookie("retiring__age")};return $.post("ba-simple-proxy.php?url="+i,t,function(){$.removeCookie("retiring__age");return console.log("Success!")})});$("video").each(function(){var e,t;t=$(this);e=t.closest(".video");e.find(".replay").on("click",function(){return t[0].play()});t.on("play",function(){var n,r,i,s;s=$("video");for(r=0,i=s.length;r<i;r++){n=s[r];n!==t[0]&&n.pause()}return e.addClass("playing")});return t.on("ended",function(){return e.removeClass("playing")})});$(".semi-autoplay").each(function(e){var t,n;t=$(this);n=t.offset().top;return u["video_"+e]=function(){if(!t.hasClass("played")&&o+r/2>n)return t.addClass("played")[0].play()}});$("body").hasClass("chapter-1-rethinking-retirement")&&function(){var e,t,n,i,s,a,f,l,c,h,p;f=$(".site_header");l=$(".story_header_wrapper");e=$(".chapter_title");t=$(".intro");c=e.offset().top;s=$(".percentage_of_workers-chart");p=s.offset().top;a=$(".data_point",s);n=$(".labor_force-chart");h=n.offset().top;i=$(".data_point",n);u.fade_header=function(){var e,t;e=0;t=0;if(r>o)return l.css({opacity:(1+e)*(t+r-o)/r})};u.shrink_header=function(){var e;e=o/r*100;return f.toggleClass("shown",e>100)};u.animate_pies=function(){return t.toggleClass("active",o>c-r)};return u.show_data_points=function(){a.toggleClass("active",o+2*r/3>p);return i.toggleClass("active",o+2*r/3>h)}}();$("body").hasClass("chapter-3-working-for-the-nest-egg")&&function(){var e,t,n,i,s,a,f,l,c;e=$(".financially_unprepared-chart");f=e.offset().top;t=$(".data_point",e);i=$(".investor_underperforms-chart");l=i.offset().top;s=$(".data_point",i);u.show_data_points=function(){t.toggleClass("active",o+2*r/3>f);return s.toggleClass("active",o+2*r/3>l)};a=$(".user_age");n=$(".how_long_work");(c=function(){var e;e=a.val();return n.toggleClass("show_over_65",e>=65)})();return a.on("keyup change",c)}();$("body").hasClass("chapter-4-working-in-retirement")&&function(){var e,t,n,i,s;n=$(".top_three_reasons");s=n.offset().top;e=$(".reasons_for_working-chart");i=e.offset().top;t=$(".data_point",e);u.animate_pies=function(){return n.toggleClass("active",o>s-r)};return u.show_data_points=function(){return t.toggleClass("active",o+2*r/3>i)}}();$("body").hasClass("chapter-5-moving-forward")&&function(){var t,n,r;t=$(".share_options");r=encodeURI("PBS NewsHour: The Retiring of Retirement");n={half_of_american_households:"Half of American households have less than $10k in savings.",death_of_the_pension:"In 1975, 85% of private sector employees had pensions. In 2013, only 35% do.",average_investor:"The average investor underperforms during inflation.",no_retirement_savings:"A third of Baby Boomers have no retirement savings."};return $("a",t).each(function(){var t,i,s;t=$(this);s=t.closest("li").attr("id");i=encodeURI(n[s]);t.attr("target","_blank");if(t.hasClass("twitter"))return t.attr("href","http://twitter.com/share?text="+i+"%20"+r+"&url="+e);if(t.hasClass("facebook"))return t.attr("href","http://www.facebook.com/sharer.php?s=100&p[title]="+r+"&p[summary]="+i+"&p[url]="+e)})}();$("#sources-open").on("click",function(){return $("#sources").fadeIn()});$("#sources-close").on("click",function(e){e.preventDefault();return $("#sources").fadeOut()});$("#credits-open").on("click",function(){return $("#credits").fadeIn()});return $("#credits-close").on("click",function(e){e.preventDefault();return $("#credits").fadeOut()})})}).call(this);