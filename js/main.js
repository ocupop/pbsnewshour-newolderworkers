// Generated by CoffeeScript 1.6.1
(function(){$(document).ready(function(){var e,t,n,r,i,s,o,u;t=$(window);n=t.height();e=$(document).height();s=1;(u=function(){window.requestAnimationFrame(u);return s=t.scrollTop()})();t.on("resize",function(){return n=t.height()});$.fn.parallax=function(e){var n,r,i,o;n=$(this);if(n.length===0)return;i=n.offset().top;r=Modernizr.prefixed("transform");t.on("resize",function(){return i=n.offset().top});return(o=function(){var t;window.requestAnimationFrame(o);t=Modernizr.csstransforms3d?"translate3d(0, "+Math.floor((i-s)*e)+"px, 0)":"translateY("+(i-s)*e+"px)";return n.css(r,t)})()};$(".background_image","section").each(function(){return $(this).parallax(-0.3)});$(".background_image",".company_photo").parallax(.3);o={};(i=function(){return setTimeout(function(){var e;for(e in o)o[e]();return t.one("scroll",i)},300)})();$("input").each(function(){var e,t;e=$(this);t=$.cookie("retiring__"+e.attr("name"));if(t)return e.val(t)});$("input").on("keyup change",function(e){var t;t=$(this);return $.cookie("retiring__"+t.attr("name"),t.val(),{expires:1})});r="https://docs.google.com/forms/d/1cujY_8JrgdzcwsScxv47lF_BY-g9Oz6u0vlrDNjZxGY/formResponse";$("#the_form").submit(function(e){var t;e.preventDefault();$(this).find("input").attr("disabled","disabled").val("Sending...");t={"entry.1728150349":$.cookie("retiring__age")};return $.post("ba-simple-proxy.php?url="+r,t,function(){$.removeCookie("retiring__age");return console.log("Success!")})});$("body").hasClass("chapter-1-rethinking-retirement")&&function(){var e,t,r,i,u,a,f,l,c,h,p;f=$(".site_header");l=$(".story_header_wrapper");e=$(".chapter_title");t=$(".intro");c=e.offset().top;u=$(".percentage_of_workers-chart");p=u.offset().top;a=$(".data_point",u);r=$(".labor_force-chart");h=r.offset().top;i=$(".data_point",r);o.fade_header=function(){var e,t;e=0;t=0;if(n>s)return l.css({opacity:(1+e)*(t+n-s)/n})};o.shrink_header=function(){var e;e=s/n*100;return f.toggleClass("shown",e>100)};o.animate_pies=function(){return t.toggleClass("active",s>c-n)};return o.show_data_points=function(){a.toggleClass("active",s+2*n/3>p);return i.toggleClass("active",s+2*n/3>h)}}();$("body").hasClass("chapter-3-working-for-the-nest-egg")&&function(){var e,t,r,i,u,a,f,l,c;e=$(".financially_unprepared-chart");f=e.offset().top;t=$(".data_point",e);i=$(".investor_underperforms-chart");l=i.offset().top;u=$(".data_point",i);o.show_data_points=function(){t.toggleClass("active",s+2*n/3>f);return u.toggleClass("active",s+2*n/3>l)};a=$(".user_age");r=$(".how_long_work");(c=function(){var e;e=a.val();return r.toggleClass("show_over_65",e>=65)})();return a.on("keyup change",c)}();$("body").hasClass("chapter-4-working-in-retirement")&&function(){var e,t,r,i,u;r=$(".top_three_reasons");u=r.offset().top;e=$(".reasons_for_working-chart");i=e.offset().top;t=$(".data_point",e);o.animate_pies=function(){return r.toggleClass("active",s>u-n)};return o.show_data_points=function(){return t.toggleClass("active",s+2*n/3>i)}}();$("#sources-open").on("click",function(){return $("#sources").fadeIn()});$("#sources-close").on("click",function(e){e.preventDefault();return $("#sources").fadeOut()});$("#credits-open").on("click",function(){return $("#credits").fadeIn()});return $("#credits-close").on("click",function(e){e.preventDefault();return $("#credits").fadeOut()})})}).call(this);